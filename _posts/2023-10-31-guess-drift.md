---
layout: post
title: "Guess drift"
date: 2023-10-31
use-math: true
comment: true
hide: true
---

$\renewcommand{\P}{\mathbb P}\newcommand{\E}{\mathbb E}\newcommand{\cF}{\mathcal F}$ 

### Problem setup

Fix $(\Omega, \mathcal F, \P)$. A random variable $\Theta$ is given. Its law is $\mu = \Theta _\\# \P$, a.k.a. the prior, is known. That is, $\E [\Theta \in B] = \mu (B)$ for any Borel set $B \subset \R$. 

Let $W _t$ be a Wiener process under $\P$. It is independent from $\Theta$ under $\P$. 

Suppose we can observe a process 

$$
	Y _t = \Theta t + W _t \implies \d Y _t = \Theta \d t + \d W _t.
$$

How do we optimally estimate the distribution of $\Theta$ from $\set{Y _t} _t$? 

That is, for $0 \le t \le T$, find the estimator 

$$
	\newcommand{\cF}{\mathcal F}
	\hat \Theta _t = \E _\P [\Theta \mid \cF ^Y _t]
$$

and its law $\hat \mu _t$. 

### Notations

1. We denote $\cF ^W _t$ to be the $\sigma$-algebra generated by $W _t$. 
2. We denote $\cF _t ^Y$ to be the $\sigma$-algebra generated by $Y _t$.
3. We denote $\cF _t$ to be the $\sigma$-algebra generated by $\Theta, W _t, Y _t$. 
4. $\cF _t = \sigma(\cF ^W _t, \cF ^Y _t)$.

### Change of measure

We want to find another measure $\newcommand{\Q}{\mathbb Q}\Q$ under which $Y _t$ becomes a Brownian motion.

1. Define 
\$\$
	Z _t = \exp \pth{\Theta W _t + \frac12 \Theta ^2 t} = \exp \pth{\Theta Y _t - \frac12 \Theta ^2 t}
\$\$
\$\$
	Z _t ^{-1} = \exp \pth{-\Theta W _t - \frac12 \Theta ^2 t} = \exp \pth{-\Theta Y _t + \frac12 \Theta ^2 t}
\$\$
2. Okay why not define $X _t = \half \pth{W _t + Y _t}$ and $Z _t = \exp (\Theta X _t)$. 
3. Define $\Q$ by \$\$
	\dfr{\Q}{\P} = Z _T ^{-1} = \exp (-\Theta X _T).
\$\$
4. $Z _t \inv$ is a martingale under $(\P, \cF _t)$. \$\$
		\d Z _t \inv = Z _t \inv (-\Theta \d X _t) +\half Z _t \inv \Theta ^2\ang{\d W _t} ^2 = Z _t \inv \pth{-\Theta \d W _t -\frac12 \Theta ^2 \dt +\half \Theta ^2 \d t} =-\Theta Z _t \inv \d W _t.
	\$\$

### Girsanov theorem 

1. Girsanov theorem shows that 
	1. $Y _t$ is a Brownian motion under $(\Q, \cF _t)$. 
	2. $\Theta$ is independent of $Y _t$ under $\Q$ (independent increment, $Y _t \perp _\Q \cF _0$).
2. $Z _t$ is a martingale under $(\cF _t, \Q)$.\$\$
		\d Z _t = Z _t (\Theta \d X _t) + \half Z _t \Theta ^2\ang{\d Y _t} ^2 = Z _t \pth{\Theta \d Y _t -\frac12 \Theta ^2 \dt +\half \Theta ^2 \d t} = \Theta Z _t \d Y _t.
	\$\$
3. $\Theta$ is has the same law under $\Q$ and under $\P$. That is, $\Theta _\\# \Q = \Theta _\\# \P = \mu$. \$\$
	\P [\Theta \in B] = \E _\P [\mathbf1 _B (\Theta)] = \E _\Q \bkt{\mathbf1 _B (\Theta) \dfr\P\Q} = \E _\Q \bkt{\mathbf1 _B (\Theta) Z _T} = \E _\Q \bkt{\mathbf1 _B (\Theta) \E _\Q[Z _T \mid \cF _0]} = \E _\Q [\mathbf1 _B (\Theta) Z _0] = \Q [\Theta \in B].
\$\$where we used that $\Theta$ is $\cF _0$-measurable and $Z _t$ is a martingale under $(\Q, \cF _t)$. Martingale times independent r.v. is still a martingale.

### Compute the estimator

1. Now we can estimate \$\$
\hat \Theta _t 
= \E _\P \bkt{\Theta \mid \cF ^Y _t} 
= \frac{\E _\Q \bkt{\Theta \dfr{\P}{\Q} \mid \cF ^Y _t}}{\E _\Q \bkt{\dfr{\P}{\Q} \mid \cF ^Y _t}}
= \frac{\E _\Q \bkt{ \E _\Q \bkt{\Theta Z _T \mid \cF _t} \mid \cF ^Y _t}}{\E _\Q \bkt{\E _\Q \bkt{Z _T \mid \cF _t} \mid \cF ^Y _t}} 
= \frac{\E _\Q \bkt{\Theta Z _t \mid \cF ^Y _t}}{\E _\Q \bkt{Z _t \mid \cF ^Y _t}} 
\$\$where again we used that $\Theta$ is $\cF _t$-measurable and $Z _t$ is a martingale under $(\cF _t, \Q)$. 
2. Compute the expectation: \$\$
	\E _{\Q} \bkt{\Theta Z _t \mid \cF ^Y _t} = \E _{\Q} \bkt{\Theta \exp \pth{\Theta Y _t - \frac12 \Theta ^2 t} \mid \cF ^Y _t} = \int _\R \theta \exp \pth{\theta Y _t - \half \theta ^2 t} \mu (\d \theta).
\$\$Here use used $\Theta \perp Y _t$ under $\Q$ and $\Theta$ has law $\mu$ under $\Q$.
3. Similarly, \$\$
	\E _{\Q} \bkt{Z _t \mid \cF ^Y _t} = \int _\R \exp \pth{\theta Y _t - \half \theta ^2 t} \mu (\d \theta).
\$\$
4. Therefore \$\$
	\hat \Theta _t = \frac{\int _\R \theta \exp \pth{\theta Y _t - \half \theta ^2 t} \mu (\d \theta)}{\int _\R \exp \pth{\theta Y _t - \half \theta ^2 t} \mu (\d \theta)} = \frac{\E _{\Theta \sim \mu} [\Theta X _t]}{\E _{\Theta \sim \mu} [X _t]}.
\$\$where $X _t = Y _t - \half \Theta t$.
5. The renewal process $N _t := \hat \Theta _t - \Theta$ is a Brownian motion under $(\P, \cF ^Y _t)$. 

### Which $\sigma$-algebra?
- $W _t$ is $(\P, \cF _t)$ BM. 
	- $W _t$ is $(\P, \cF ^W _t)$ BM + $W _t \perp \Theta$ $\iff$ $W _t$ is $(\P, \cF _t)$ BM
	- $$ 
		\E [W _t \mid \cF _s] = \E [W _t \mid \sigma(\cF ^W _s, \Theta)] = \E [W _s \mid \cF ^W _s] = W _s
	$$
	- $$
		\E [W _t \mid \cF ^W _s] = \E [\E [W _t \mid \cF _s] \mid \cF ^W _s] = \E [W _s \mid \cF ^W _s] = W _s.
	$$